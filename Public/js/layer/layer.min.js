/**************************************************************

 @Name : layer v1.4.2-1 弹层组件压缩版
 @author: 贤心
 @date: 2012-12-2
 @blog: http://xu.sentsin.com
 @微博：http://t.qq.com/xian_xin
 @QQ群：176047238(layer交流2群)
 @Copyright: Sentsin Xu(贤心)
 @官网说明：http://xu.sentsin.com/jquery/layer
 @赞助layer: https://me.alipay.com/sentsin
		
 *************************************************************/ 

;void function(a,d){

var b=true, //是否采用自动获取绝对路径。 false：将采用相对路径(需在下述变量中配置)
e="",  //相对路径url

c=function(){var j=jQuery,h={getPath:function(){var l=document.scripts||j("script"),k=l[l.length-1].src;return k.substring(0,k.lastIndexOf("/")+1)},append:function(){b&&(e=this.getPath());var k='<!--[if IE 6]><script type="text/javascript" src="'+e+'skin/png.js"><\/script><![endif]-->';j("head").prepend('\n<link rel="stylesheet" id="layerCss" type="text/css" href="'+e+'skin/layer.css"  />'+k)},global:{iE6:!-[1,]&&!a.XMLHttpRequest,times:0,config:{}}},g=j(a),f=Function();h.append();f.prototype={v:"1.4.2",alert:function(l,m,n,k){return j.layer({dialog:{msg:l,type:m,yes:k},title:n})},confirm:function(l,k,m,n){return j.layer({dialog:{msg:l,type:4,btns:2,yes:k,no:n},title:m})},msg:function(m,l,k,n){(m==""||m==d)&&(m="&nbsp;");(l==d||l=="")&&(l=2);return j.layer({dialog:{msg:m,type:k,maxWidth:n},time:l,title:["",false],closeBtn:["",false]})},tips:function(l,k,n,m){return j.layer({type:4,shade:false,time:n,maxWidth:m,tips:{msg:l,follow:k}})},load:function(l,n,k){var m=true;n==3&&(m=false);return j.layer({time:l,shade:k,loading:{type:n},border:[10,0.3,"#000",m],type:3,title:["",false],closeBtn:[0,false]})}};layer=new f();var i=function(k){this.init(k)};i.prototype={type:function(){return["dialog","page","iframe","loading","tips"]},config:{skin:0,shade:[0.5,"#000",true],shadeClose:false,fix:true,move:[".xubox_title",true],type:0,title:["信息",true],offset:["200px","50%"],area:["310px","auto"],closeBtn:[0,true],time:0,border:[10,0.3,"#000",true],zIndex:19891014,maxWidth:400,fadeIn:[300,false],dialog:{btns:1,btn:["确定","取消"],type:3,msg:"",yes:function(k){LAYER.close(k)},no:function(k){LAYER.close(k)}},page:{dom:"#xulayer"},iframe:{src:"http://xu.sentsin.com"},loading:{type:0},tips:{msg:"",follow:""},success:function(k){},close:function(k){LAYER.close(k)},end:function(){}},init:function(m){var l=j.now();h.global.times++;var k=this.config;this.config=j.extend({},k,m);this.dialog=j.extend({},k.dialog,m.dialog);this.page=j.extend({},k.page,m.page);this.iframe=j.extend({},k.iframe,m.iframe);this.loading=j.extend({},k.loading,m.loading);this.tips=j.extend({},k.tips,m.tips);this.adjust();var n=j.now();this.layerE.attr("msec",(n-l)+"ms")},space:function(){var k=h.global.times,l=h.global.config[k]=this.config;l.dialog=this.dialog;l.page=this.page;l.iframe=this.iframe;l.loading=this.loading;l.tips=this.tips;var n=this.config,q=this.dialog,m=['<div class="xubox_dialog"><span class="xubox_msg xulayer_png32 xubox_msgico xubox_msgtype'+q.type+'"></span><span class="xubox_msg xubox_text">'+q.msg+"</span></div>",'<div class="xubox_page xubox_page_'+n.skin+'"></div>','<iframe id="xubox_iframe" name="xubox_iframe" onload="javascript:$(\'.xubox_layer\').find(\'.xubox_iframe\').removeClass(\'xubox_load\');" class="xubox_iframe" frameborder="0" src="'+this.iframe.src+'"></iframe>','<span class="xubox_loading xubox_loading_'+this.loading.type+'"></span>','<div class="xubox_tips xubox_tips_'+n.skin+'"><div class="xubox_tipsMsg">'+this.tips.msg+'</div><i class="xulayer_png32"></i></div>'];var s="",o="",k=h.global.times;this.zIndex=n.zIndex+k;var r=this.zIndex,t="z-index:"+r+"; background:"+n.shade[1]+"; opacity:"+n.shade[0]+"; filter:'alpha(opacity="+n.shade[0]*100+")'; filter:alpha(opacity="+n.shade[0]*100+");";n.shade[2]&&(s='<div times="'+k+'" id="xubox_shade'+k+'" class="xubox_shade xubox_shade_'+n.skin+'" style="'+t+'"></div>');var u="z-index:"+(r-1)+";  background: "+n.border[2]+"; opacity:"+n.border[1]+"; filter:'alpha(opacity="+n.border[1]*100+")'; filter:alpha(opacity="+n.border[1]*100+"); top:-"+n.border[0]+"px; left:-"+n.border[0]+"px;";n.border[3]&&(o='<div id="xubox_border'+k+'" class="xubox_border" style="'+u+'"></div>');var p='<div times="'+k+'" showtime="'+n.time+'" style="z-index:'+r+'" id="xubox_layer'+k+'" class="xubox_layer xubox_layer_'+n.skin+'"><div style="z-index:'+r+'" class="xubox_main xubox_main_'+n.skin+'">'+m[n.type]+'<h2 class="xubox_title xubox_title_'+n.skin+'"><i class="xulayer_png32"></i><em>'+n.title[0]+'</em></h2><a class="xubox_close xulayer_png32 xubox_close'+n.closeBtn[0]+"_"+n.skin+'" href="javascript:;"></a><span class="xubox_botton"></span></div>'+o+"</div>";return[s,p]},adjust:function(){var m=this,k="",n=this.config,r=this.dialog,q=this.page,p=function(){k=m.space();j("body").append(k[0])};switch(n.type){case 1:if(j(q.dom).parents(".xubox_page").length==0){p();j(q.dom).show().wrap(k[1])}else{return false}break;case 2:j(".xubox_layer").find(".xubox_iframe").length>0&&LAYER.close(j(".xubox_iframe").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);break;case 3:n.title=["",false];n.area=["auto","auto"];n.closeBtn=["",false];j(".xubox_layer").find(".xubox_loading").length>0&&LAYER.close(j(".xubox_loading").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);break;case 4:n.title=["",false];n.area=["auto","auto"];n.fix=false;n.border=[0,0,0,false];j(".xubox_layer").find(".xubox_tips").length>0&&LAYER.close(j(".xubox_tips").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);j(".xubox_tips").fadeIn(200).parents(".xubox_layer").find(".xubox_close").css({top:5,right:5});break;default:n.title[1]||(n.area=["auto","auto"]);j(".xubox_layer").find(".xubox_dialog").length>0&&LAYER.close(j(".xubox_dialog").parents(".xubox_layer").attr("times"));p();j("body").append(k[1]);break}var l=h.global.times;this.layerS=j("#xubox_shade"+l);this.layerB=j("#xubox_border"+l);this.layerE=j("#xubox_layer"+l);var o=this.layerE;if(n.offset[1].indexOf("px")!=-1){var s=parseInt(n.offset[1])}else{if(n.offset[1]=="50%"){var s=n.offset[1]}else{var s=parseInt(n.offset[1])/100*g.width()}}o.css({left:s+n.border[0],width:n.area[0],height:n.area[1]});n.fix?o.css({top:parseInt(n.offset[0])+n.border[0]}):o.css({top:parseInt(n.offset[0])+g.scrollTop()+n.border[0],position:"absolute"});this.layerMian=o.find(".xubox_main");this.layerTitle=o.find(".xubox_title");this.layerText=o.find(".xubox_text");this.layerPage=o.find(".xubox_page");this.layerBtn=o.find(".xubox_botton");if(n.type==0&&n.title[1]){switch(r.btns){case 0:this.layerBtn.html("").hide();break;case 2:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton2_'+n.skin+'">'+r.btn[0]+'</a><a href="javascript:;" class="xubox_no xubox_botton3_'+n.skin+'">'+r.btn[1]+"</a>");break;default:this.layerBtn.html('<a href="javascript:;" class="xubox_yes xubox_botton1_'+n.skin+'">'+r.btn[0]+'</a><a class="xubox_no" style="displa:none;"></a>')}}if(o.css("left")==="auto"){o.hide();setTimeout(function(){o.show();m.pagetype(l)},500)}else{this.pagetype(l)}this.callback(n)},pagetype:function(k){var l=this,o=this.layerE,m=this.config,r=this.page;l.autoArea(k);m.time==0||this.autoclose();m.move[1]?o.find(".xubox_title").css({cursor:"move"}):o.find(".xubox_title").css({cursor:"auto"});m.closeBtn[1]||o.find(".xubox_close").remove().hide();if(!m.title[1]){o.find(".xubox_title").remove().hide();m.type!=4&&o.find(".xubox_close").removeClass("xubox_close0_"+m.skin).addClass("xubox_close1_"+m.skin)}else{this.layerTitle.css({width:o.outerWidth()})}m.border||o.removeClass("xubox_layerBoder");var p=parseInt(this.layerMian.css("margin-right")),q=parseInt(o.css("padding-bottom"));o.attr({type:l.type()[m.type]});switch(m.type){case 1:o.find(r.dom).addClass("layer_pageContent");this.layerPage.css({width:o.width()-2*p});m.shade&&o.css({"z-index":l.zIndex+1});m.title[1]?this.layerPage.css({top:p+this.layerTitle.outerHeight()}):this.layerPage.css({top:p});break;case 2:o.find(".xubox_iframe").addClass("xubox_load").css({width:o.width()-2*p});m.title[1]?o.find(".xubox_iframe").css({top:this.layerTitle.height()+q,height:o.height()-this.layerTitle.height()}):o.find(".xubox_iframe").css({top:q,height:o.height()});h.global.iE6&&o.find("#xubox_iframe").attr("src",l.iframe.src);break;case 4:var s=j(l.tips.follow).offset().top-j(l.tips.follow).outerHeight()-o.outerHeight()+15;var n=j(l.tips.follow).offset().left+o.outerWidth()/2;o.css({top:s,left:n});break;default:if(m.title[1]){this.layerText.css({paddingTop:18+this.layerTitle.outerHeight()})}else{o.find(".xubox_msgico").css({top:"10px"});this.layerText.css({marginTop:12})}break}var t=0;m.fadeIn[1]&&(t=m.fadeIn[0]);o.animate({opacity:1,filter:"alpha(opacity="+100+")"},t);this.move()},autoArea:function(l){var n=this,s=j("#xubox_layer"+l),o=h.global.config[l],u=o.page,p=s.find(".xubox_main"),m=s.find(".xubox_botton"),q=s.find(".xubox_text"),k=s.find(".xubox_page"),t=j("#xubox_border"+l);if(o.area[0]=="auto"&&p.outerWidth()>=o.maxWidth){s.css({width:o.maxWidth})}o.title[1]?titHeight=s.find(".xubox_title").innerHeight():titHeight=0;switch(o.type){case 0:var v=m.find("a"),w=q.outerHeight()+20;if(v.length>0){var r=m.find("a").outerHeight()+20}else{var r=0}break;case 1:var r=0,w=j(u.dom).outerHeight();o.area[0]=="auto"&&s.css({width:k.outerWidth()});break;case 3:var r=0;var w=j(".xubox_loading").outerHeight();p.css({width:j(".xubox_loading").width()});break}(o.offset[1]=="50%"||o.offset[1]=="")?s.css({marginLeft:-s.outerWidth()/2}):s.css({marginLeft:0});(o.area[1]=="auto")&&p.css({height:titHeight+w+r});t.css({width:s.outerWidth()+2*o.border[0],height:s.outerHeight()+2*o.border[0]});(h.global.iE6&&o.area[0]!="auto")&&p.css({width:s.outerWidth()})},move:function(){var l=this.config,k=this.layerE.find(l.move[0]);l.move[1]&&k.attr("move","ok");j(l.move[0]).mousedown(function(q){q.preventDefault();var p=j(this).parents(".xubox_layer");if(j(this).attr("move")==="ok"){var n=true,o=q.pageX-parseInt(p.position().left),m=q.pageY-parseInt(p.position().top);j(document).mousemove(function(t){if(n){var r=t.pageX-o;if(p.css("position")=="fixed"){var s=t.pageY-m-g.scrollTop()}else{var s=t.pageY-m}p.css({left:r,top:s})}}).mouseup(function(){n=false})}})},autoclose:function(){j.each(h.global.config,function(l,n){var o=n.time;var k=function(){o--;o===0&&LAYER.close(l);j(".xubox_layer").length<1&&clearInterval(m)};var m=setInterval(k,1000)})},callback:function(n){LAYER=new this.openLayer(this);var m=this.layerE,k=this.config,l=this.dialog;this.config.success(m);h.global.iE6&&this.IE6();j(".xubox_close").off("click").on("click",function(){var o=j(this).parents(".xubox_layer").attr("times");try{h.global.config[o].close(o)}catch(p){LAYER.close(o)}});m.find(".xubox_yes").off("click").on("click",function(){var o=j(this).parents(".xubox_layer").attr("times");l.yes(o)});m.find(".xubox_no").off("click").on("click",function(){var o=j(this).parents(".xubox_layer").attr("times");l.no(o)});this.layerS.off("click").on("click",function(){var o=j(this).attr("times");h.global.config[o].shadeClose&&LAYER.close(o)})},IE6:function(){var o=this,p=this.layerE,l=j("select"),k=function(){var q=[j(document).width(),j(document).height(),g.width()];q[0]>q[1]&&(q[0]=q-17);o.layerS.css({width:q[0],height:q[1]})};k();g.resize(k).scroll(k);var n=p.offset().top;if(this.config.fix){var m=function(){p.css({top:j(document).scrollTop()+n})}}else{var m=function(){p.css({top:n})}}m();g.scroll(m);j.each(l,function(q,r){var s=j(this);if(!s.parents(".xubox_layer")[0]){s.css("display")=="none"||s.attr({layer:"1"}).hide()}});this.reselect=function(){j.each(l,function(q,r){var s=j(this);if(!s.parents(".xubox_layer")[0]){(s.attr("layer")==1&&j(".xubox_layer").length<1)&&s.removeAttr("layer").show()}})};DD_belatedPNG.fix(".xulayer_png32")},openLayer:function(k){this.autoArea=function(l){if(typeof l!="number"){return k.autoArea(h.global.times)}else{return k.autoArea(l)}};this.getIndex=function(l){return j(l).parents(".xubox_layer").attr("times")};this.getChildFrame=function(l){return j("#xubox_iframe").contents().find(l)};this.getFrameIndex=function(){return j("#xubox_iframe").parents(".xubox_layer").attr("times")};this.close=function(m){var o=j("#xubox_layer"+m),l=j("#xubox_shade"+m);if(o.attr("type")==k.type()[1]){o.find(".xubox_close,.xubox_botton,.xubox_title,.xubox_border").remove();for(var n=0;n<3;n++){o.find(".layer_pageContent").unwrap().hide()}}else{j.browser.msie&&o.find("#xubox_iframe").remove();o.remove()}l.remove();try{h.global.iE6&&k.reselect();h.global.config[m].end();h.global.times--;delete h.global.config[m]}catch(p){}};this.loadClose=function(){var m=j(".xubox_loading").parents(".xubox_layer"),l=m.attr("times");j("#xubox_shade"+l).remove();m.remove()};this.shift=function(q,p){var n=k.config,o=h.global.iE6,s=k.layerE,m=0,r=g.width(),l=g.height();(n.offset[1]=="50%"||n.offset[1]=="")?m=s.outerWidth()/2:m=s.outerWidth();switch(q){case"left-top":s.css({left:m+n.border[0],top:-s.outerHeight()}).animate({top:n.border[0]},p,function(){o&&k.IE6()});break;case"right-top":s.css({left:r-m-n.border[0],top:-s.outerHeight()}).animate({top:n.border[0]},p,function(){o&&k.IE6()});break;case"left-bottom":s.css({left:m+n.border[0],top:l}).animate({top:l-s.outerHeight()-n.border[0]},p,function(){o&&k.IE6()});break;case"right-bottom":s.css({left:r-m-n.border[0],top:l}).animate({top:l-s.outerHeight()-n.border[0]},p,function(){o&&k.IE6()});break}}}};j.layer=function(k){return new i(k)}};

var require = '../../init/jquery'; //若采用seajs模块加载器，需正确配置jquery的相对路径。未用可无视此处。
if(typeof define==="function"&&typeof seajs==="object"){define([require],function(g,f,h){c();f.layer=[a.layer,a["$"].layer]})}else{c()}

}(window);	
